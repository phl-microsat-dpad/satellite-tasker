{% extends "base.html" %}

{% block cssimports %}
<style>
    #map {
        width: 100%;
        height: 100%;
    }
</style>
{% endblock %}

{% block content %}
<h1>Imagery Request Form</h1>

<form id="order-form">
    <div class="form-group">
        <label for="order-fname">First Name</label>
        <input type="text" class="form-control" id="order-fname" placeholder="First Name" name="fname"/>
    </div>

    <div class="form-group">
        <label for="order-lname">Last Name</label>
        <input type="text" class="form-control" id="order-lname" placeholder="Last Name" name="lname"/>
    </div>

    <div class="form-group">
        <label for="order-email">Email Address</label>
        <input type="email" class="form-control" id="order-email" placeholder="Email" name="email"/>
    </div>
    
    <div class="form-group">
        <div id="map"></div>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
</form>

{% endblock %}


{% block jsimports %}
<script type="text/javascript">
    $(document).ready(function(){
        $("#order-form").on("submit", function(e){
            e.preventDefault();
            $.post("/api/order", $("#order-form").serializeArray());
        });

        initialize_map();
    });    

    function initialize_map(){
        // initialize map
        var map = L.map('map');

        var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
        var osmAttrib='Map data Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors';
        var osm = new L.TileLayer(osmUrl, {minZoom: 2, maxZoom: 12, attribution: osmAttrib});       

        map.setView(new L.LatLng(11.5, 121.8), 6);
        map.addLayer(osm);

        // add AreaSelect with keepAspectRatio:true
        var areaSelect = L.areaSelect({
            width:100, 
            height:100, 
        });
        areaSelect.addTo(map);
     
        // Get a callback when the bounds change
        areaSelect.on("change", function() {
            console.log("Bounds:", this.getBounds());
        });
    }
</script>
{% endblock %}